import requests  # requests HTTP library


class HttpResponseExploit():
    """
	implements the http response code exploit
	strategy
	"""

    def execute(self, pages, session, strategy):
        """
		execute strategy
		"""
        print(strategy)
        vectors = strategy.getVectors()

        print("Sending requests to vectors and checking for status codes other than 200...")

        for page in pages:
            forms = page.get("inputs").get("forms")
            url = page.get("url")

            for form in forms:
                for vector in vectors:

                    response = strategy.executeVector(url, vector, form)

                    # check if there is a response and test it if it does
                    if hasattr(response, 'status_code'):
                        if response.status_code != requests.codes.ok:
                            print("HTTP Response !200 - \n  Page: %s\n  Form: %s\n  Vector: %s\n  Status:Code: %s\n"
                                  % (url, form, vector, response.status_code))
